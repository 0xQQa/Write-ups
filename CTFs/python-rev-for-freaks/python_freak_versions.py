#helper
import sys
sys.setrecursionlimit(420_69 + 1000)

#Form no 1

𝓿 = 𝓉𝔂𝓹𝓮("m", (), {"__init__": lambda 𝔞, ｂ: 𝓈𝔢ｔ𝒶𝓽ｔ𝓻(𝒶, "b", 𝔟), "s": lambda 𝒶, ｂ: 𝔳(𝔟(𝔞.𝒷).𝓫)})
𝒸 = 𝔱𝓎𝓹𝓮("l", (), {"__init__": lambda 𝔞, 𝔟: 𝔰𝑒𝓽ａ𝓉𝓉𝔯(ａ, "b", 𝓫), "d": lambda ａ, 𝔟: 𝔞 if 𝓋(ａ.𝒷).ｓ(𝒷).𝔟 != ｂ(ａ.𝔟).𝓫 else ｂ(𝔞.𝔟)})
𝔪 = lambda 𝔵: 𝔠(f"{𝓵𝔦𝓈𝔱(𝓏𝔦𝔭([𝓁(𝔦 + 5*𝔦) for ｉ in 𝔁], [𝔩(𝔦 + 𝓲) for 𝔦 in 𝔵][::-1]))[::-1] = }")
𝔫 = lambda ｘ: 𝒸("{x[';]:=^450}".forｍ𝒶𝓽(𝔵={'''';''': 𝔵}))
𝔩 = lambda 𝔁: (12648430 ^ (𝔵 + 3735928559)) * 3862272608
𝓀 = 𝓲ｎ𝔭𝔲𝓽("Insert your flag: ")
𝓈 = [(lambda 𝔷, ｆ, ｘ, 𝔫: 𝓍 if 𝓷 == 0 else 𝔣(𝔷, 𝒻, (lambda 𝓶, 𝓃: (lambda 𝓍: 𝒾ｎ𝔱(𝔁[ｌ𝔢𝔫(𝔵)-59:], 2) + 𝒾𝓷𝓽(𝔵[:𝔩𝓮ｎ(𝔁)-59], 2) if 𝔩ｅ𝔫(𝔁)-59 > 0 else 𝔦ｎ𝓽(𝔵,2))(ｂ𝒾𝔫(𝓶 * 𝓷)))(𝔁, 𝔃), ｎ - 1))(𝔰𝔲𝓂((ｏ𝔯𝔡(𝔨[𝓲+𝒿]) << 𝒿*7) if ｉ+ｊ < ｌ𝔢𝔫(𝓴) else (127 << 𝒿*7) for 𝔧 in 𝓇𝔞ｎ𝑔𝔢(8)), (lambda 𝔷, 𝓯, ｘ, 𝔫: ｘ if 𝔫 == 0 else ｆ(𝔷, 𝓯, (lambda 𝔫, 𝔪: (lambda 𝔵: ｉｎ𝔱(ｘ[𝓁ｅ𝔫(𝓍)-59:], 2) + 𝓲ｎｔ(𝔁[:𝓁𝑒𝔫(𝔵)-59], 2) if 𝓵𝑒𝔫(𝓍)-59 > 0 else 𝒾ｎ𝓽(ｘ,2))(𝓫𝔦𝔫(𝓷 * 𝔪)))(𝔁, 𝔷), 𝔫 - 1)), 1, 420_69) for 𝔦 in 𝓇ａ𝓷𝑔ｅ(0, 𝓁𝔢𝓷(𝔨), 8)]
print(𝓬(ｓ).𝔡(𝔪).𝒹(𝔫).ｂ )
if 𝓬(ｓ).𝔡(𝔪).𝒹(𝔫).ｂ == "=𝓵𝔦𝓈𝔱(𝓏𝔦𝔭([𝓁(𝔦 + 5*𝔦) for ｉ in 𝔁], [𝔩(𝔦 + 𝓲) for 𝔦 in 𝔵][::-1]))[::-1] = [(13969439442922757926633137632, 3251133470245911671632840864), (6919844817045365871489845728, 3067821989026578174692487328), (11408842561461143227463443808, 3766356150094573135206359136), (11299068421490417286376379488, 3802947530149782083826679648), (9203465938188223031329433888, 2306614948612889330244181216), (9753400381846729757945770272, 4656479823873291748257812704)]==":
    𝔭𝓻ｉ𝓷ｔ("Good flag!")
else:
    𝓹ｒ𝔦𝔫𝔱("Wrong flag!")

#Form no 2

v = type("m", (), {"__init__": lambda a, b: setattr(a, "b", b), "s": lambda a, b: v(b(a.b).b)})
c = type("l", (), {"__init__": lambda a, b: setattr(a, "b", b), "d": lambda a, b: a if v(a.b).s(b).b != b(a.b).b else b(a.b)})
m = lambda x: c(f"{list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = }")
n = lambda x: c("{x[';]:=^450}".format(x={'''';''': x}))
l = lambda x: (12648430 ^ (x + 3735928559)) * 3862272608
#k = input("Insert your flag: ")
s = [
(lambda z, f, x, n: x if n == 0 else f(z, f,
(lambda m, n:
(lambda x: int(x[len(x)-59:], 2) + int(x[:len(x)-59], 2) if len(x)-59 > 0 else int(x,2))(bin(m * n)))(x, z), n - 1))(sum((ord(k[i+j]) << j*7) if i+j < len(k) else (127 << j*7) for j in range(8)),
(lambda z, f, x, n: x if n == 0 else f(z, f,
(lambda n, m:
(lambda x: int(x[len(x)-59:], 2) + int(x[:len(x)-59], 2) if len(x)-59 > 0 else int(x,2))(bin(n * m)))(x, z), n - 1)), 1, 420_69) for i in range(0, len(k), 8)]
print(c(s).d(m).d(n).b)
if c(s).d(m).d(n).b == "=list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = [(13969439442922757926633137632, 3251133470245911671632840864), (6919844817045365871489845728, 3067821989026578174692487328), (11408842561461143227463443808, 3766356150094573135206359136), (11299068421490417286376379488, 3802947530149782083826679648), (9203465938188223031329433888, 2306614948612889330244181216), (9753400381846729757945770272, 4656479823873291748257812704)]==":
    print("Good flag!")
else:
    print("Wrong flag!")

#Form no 3 

class v:
    def __init__(self, b) -> None:
        self.b = b

    def s(self, b):
        return v(b(self.b).b)

class c:
    def __init__(self, b) -> None:
        self.b = b

    def d(self, b):
        return self if v(self.b).s(b).b != b(self.b).b else b(self.b)

def l(x):
    x += 0xDEAD_BEEF
    x ^= 0xC0FFEE
    x *= 0xE635_9A60
    return x

def m(x):
    l1 = [l(6 * j) for j in x]
    l2 = [l(2 * j) for j in x]
    l2 = reversed(l2)
    result = list(zip(l1, l2))

    return c(f"list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = {result}")

def n(x):
    return c("{x[';]:=^450}".format(x={'''';''': x}))

#k = input("Insert your flag: ")
op1 = lambda x: int(x[len(x)-59:], 2) + int(x[:len(x)-59], 2) if len(x)-59 > 0 else int(x,2)
op2 = lambda m, n: op1(bin(m * n))
op3 = lambda z, f, x, n: x if n == 0 else f(z, f, op2(x, z), n - 1)
op4 = lambda i: sum((ord(k[i+j]) << j*7) if i+j < len(k) else (127 << j*7) for j in range(8))
s = [op3(op4(i), op3, 1, 420_69) for i in range(0, len(k), 8)]

print(c(s).d(m).d(n).b)
if c(s).d(m).d(n).b == "=list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = [(13969439442922757926633137632, 3251133470245911671632840864), (6919844817045365871489845728, 3067821989026578174692487328), (11408842561461143227463443808, 3766356150094573135206359136), (11299068421490417286376379488, 3802947530149782083826679648), (9203465938188223031329433888, 2306614948612889330244181216), (9753400381846729757945770272, 4656479823873291748257812704)]==":
    print("Good flag!")
else:
    print("Wrong flag!")

#Form no 4 

class c:
    def __init__(self, b) -> None:
        self.b = b

    def d(self, b):
        return b(self.b)

def l(x):
    x += 0xDEAD_BEEF
    x ^= 0xC0FFEE
    x *= 0xE635_9A60
    return x

def m(x):
    l1 = [l(6 * j) for j in x]
    l2 = [l(2 * j) for j in x]
    l2 = reversed(l2)
    result = list(zip(l1, l2))

    return c(f"list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = {result}")

def n(x):
    return c(x.center(450, '='))

#k = input("Insert your flag: ")
def op1(x):
    return x % (2**59 - 1) # == int(x[len(x)-59:], 2) + int(x[:len(x)-59], 2) if len(x)-59 > 0 else int(x,2)

def op2(m, n):
    return op1(m * n) # == bin(m * n))

def op3(z, f, x, n):
    if n == 0:
        return x

    return f(z, f, op2(x, z), n - 1)

def op4(i):
    result = 0

    for j in range(8):
        if i+j < len(k):
            result += ord(k[i+j]) << j*7
        else:
            result += (0x7F << j*7)

    return result

def s():
    result = list()

    for i in range(0, len(k), 8):
        tmp_result = op3(op4(i), op3, 1, 420_69)
        result.append(tmp_result)

    return result

s = s()
print(c(s).d(m).d(n).b)
if c(s).d(m).d(n).b == "=list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = [(13969439442922757926633137632, 3251133470245911671632840864), (6919844817045365871489845728, 3067821989026578174692487328), (11408842561461143227463443808, 3766356150094573135206359136), (11299068421490417286376379488, 3802947530149782083826679648), (9203465938188223031329433888, 2306614948612889330244181216), (9753400381846729757945770272, 4656479823873291748257812704)]==":
    print("Good flag!")
else:
    print("Wrong flag!")

#Form no 5 

def l(x):
    x += 0xDEAD_BEEF
    x ^= 0xC0FFEE
    x *= 0xE635_9A60
    return x

def m(x):
    l1 = [l(6 * j) for j in x]
    l2 = [l(2 * j) for j in x]
    l2 = reversed(l2)
    result = list(zip(l1, l2))

    return f"list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = {result}"

def n(x):
    return x.center(450, '=')

#k = input("Insert your flag: ")

def op4(k, i):
    result = 0

    for j in range(8):
        if i+j < len(k):
            result += ord(k[i+j]) << j*7
        else:
            result += (0x7F << j*7)

    return result


def s(user_inp):
    result_arr = []
    for idx in range(0, len(user_inp), 8):
        n = op4(user_inp, idx)
        m = 1
        cnt = 420_69
        while cnt > 0:
            cnt -= 1
            m = (m * n) % (2**59 - 1)

        result_arr.append(m)

    return result_arr

s = s(k)
print(n(m(s)))
if n(m(s)) == "=list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = [(13969439442922757926633137632, 3251133470245911671632840864), (6919844817045365871489845728, 3067821989026578174692487328), (11408842561461143227463443808, 3766356150094573135206359136), (11299068421490417286376379488, 3802947530149782083826679648), (9203465938188223031329433888, 2306614948612889330244181216), (9753400381846729757945770272, 4656479823873291748257812704)]==":
    print("Good flag!")
else:
    print("Wrong flag!")

#Form no 6

def l(x):
    x += 0xDEAD_BEEF
    x ^= 0xC0FFEE
    x *= 0xE635_9A60
    return x

def m(x):
    l1 = [l(6 * j) for j in x]
    l2 = [l(2 * j) for j in x]
    l2 = reversed(l2)
    result = list(zip(l1, l2))

    return f"list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = {result}"

def n(x):
    return x.center(450, '=')

#k = input("Insert your flag: ")

def prepare_input(k, i):
    result = 0

    for j in range(8):
        if i+j < len(k):
            result += ord(k[i+j]) << j*7
        else:
            result += (0x7F << j*7)

    return result

def rsa_encrypt(n):
    m = (n ** 420_69) % (2**59 - 1)
    return m

def s(user_inp):
    result_arr = []
    for idx in range(0, len(user_inp), 8):
        n = prepare_input(user_inp, idx)
        m = rsa_encrypt(n)
        result_arr.append(m)

    return result_arr

s = s(k)
print(n(m(s)))
if n(m(s)) == "=list(zip([l(i + 5*i) for i in x], [l(i + i) for i in x][::-1]))[::-1] = [(13969439442922757926633137632, 3251133470245911671632840864), (6919844817045365871489845728, 3067821989026578174692487328), (11408842561461143227463443808, 3766356150094573135206359136), (11299068421490417286376379488, 3802947530149782083826679648), (9203465938188223031329433888, 2306614948612889330244181216), (9753400381846729757945770272, 4656479823873291748257812704)]==":
    print("Good flag!")
else:
    print("Wrong flag!")



