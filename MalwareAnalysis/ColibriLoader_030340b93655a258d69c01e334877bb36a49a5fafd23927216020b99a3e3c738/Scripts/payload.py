import idc
import idaapi

def nop_jump_predictions():
    search_bytes = "74 03 75 01 B8"  
    replace_bytes = b"\x90" * 5 
    ea_start = 0x4055A7
    ea_end = 0x00405C00
    ea = idaapi.find_binary(ea_start, ea_end, search_bytes, 16, idaapi.SEARCH_DOWN)
    while ea != idaapi.BADADDR:
        print(f"Patching at {hex(ea)} ...done")
        idaapi.patch_bytes(ea, replace_bytes)
        ea = idaapi.find_binary(ea + 1, ea_end, search_bytes, 16, idaapi.SEARCH_DOWN)

    print(f"Fixed all cases of jz/jnz obfuscation")

if __name__ == "__main__":
  nop_jump_predictions()